<img src="https://github.com/user-attachments/assets/17c9e271-024c-4486-b2c9-615456286009" alt="Microsoft_Windows_7_logotype" width="400" height="230">

<h1>Resetting a Windows 7 Password Using the Sticky Keys Exploit üíªüõ°Ô∏è</h1>

This project demonstrates how to reset a forgotten password on a Windows 7 machine by exploiting the Sticky Keys accessibility feature. This method uses the system's built-in repair option, avoiding the need for external bootable media. We demonstrate the practical steps to exploit Windows accessibility features for password recovery, emphasizing their impact on system security and potential vulnerabilities in older operating systems.

<h2>Environments and Technologies Used</h2>

- Gateway Laptop N214


<h2>Operating Systems Used </h2>

- Windows 7 Home Premium


<h2>Back Door Configuration Steps Utilizing the GUI</h2>

‚ë† **Switch On and Power Off:**
   - Turn on your Windows 7 PC. When you see the "Starting Windows" page, press and hold the **Power** button for several seconds to force the device to power off.

‚ë° **Boot to Startup Repair:**
   - Power on the device again. On boot, you will see two options: **Launch Startup Repair** and **Start Normally**. Select **Launch Startup Repair**.

   <img width="350" alt="Launch Startup Repair" src="https://github.com/YourRepo/YourImagePath/startup-repair.png">

‚ë¢ **Cancel Automatic Restore:**
   - When the Startup Repair interface appears, it will ask if you want to restore the computer. Click **Cancel**.

   <img width="350" alt="Cancel Restore" src="https://github.com/YourRepo/YourImagePath/cancel-restore.png">

‚ë£ **View Problem Details:**
   - A dialog will inform you that your computer can't be automatically repaired. Click **View Problem Details**.

   <img width="350" alt="View Problem Details" src="https://github.com/YourRepo/YourImagePath/view-problem-details.png">

‚ë§ **Open Notepad:**
   - An offline privacy statement will appear. Click the last link at the bottom of the statement to open it in **Notepad**.

   <img width="350" alt="Open Notepad" src="https://github.com/YourRepo/YourImagePath/open-notepad.png">

‚ë• **Access Command Prompt via Notepad:**
   - In Notepad, go to the **File** menu and select **Open**. Change the file type filter to **All Files**.

   - Navigate to `C:\Windows\System32` and find `sethc.exe`. Rename it to `sethc-copy.exe`.

   - Find `cmd.exe` in the same directory, and rename it to `sethc.exe`.

   - Close the **Open** dialog and click **Finish**. The computer will reboot.

   <img width="350" alt="Rename Files in Notepad" src="https://github.com/YourRepo/YourImagePath/rename-files-notepad.png">

‚ë¶ **Trigger Command Prompt:**
   - On the Windows 7 login page, press the **Shift** key five times rapidly. This will open Command Prompt with administrative privileges.

   <img width="350" alt="Command Prompt via Sticky Keys" src="https://github.com/YourRepo/YourImagePath/command-prompt.png">

‚ëß **Reset the Password:**
   - In Command Prompt, type the following command to reset the password for the target user account:

     ```cmd
     net user [username] [newpassword]
     ```

   - Replace `[username]` with the username of the account and `[newpassword]` with the new password. For example:

     ```cmd
     net user JaneDoe P@ssw0rd123
     ```

   - Press **Enter** to execute the command.

   <img width="350" alt="Reset Password in Command Prompt" src="https://github.com/YourRepo/YourImagePath/reset-password.png">

‚ë® **Restore Original sethc.exe File:**
   - To restore the original Sticky Keys functionality, reopen Command Prompt (press **Shift** five times) and type the following command:

     ```cmd
     copy C:\Windows\System32\sethc-copy.exe C:\Windows\System32\sethc.exe
     ```

   - Confirm the file replacement when prompted.

   <img width="350" alt="Restore Original File" src="https://github.com/YourRepo/YourImagePath/restore-file.png">

‚ë© **Log In with the New Password:**
   - Close Command Prompt and log in using the new password you created.
   - Ensure that Sticky Keys is functioning as expected.

   <img width="350" alt="Login Screen" src="https://github.com/YourRepo/YourImagePath/login-screen.png">


<h2>Back Door Configuration Steps Utilizing the Command Line</h2>

‚ë† **Access the Windows 7 Computer:**
   Boot the Windows 7 computer and allow it to reach the login screen.

‚ë° **Initiate Repair Options:**
   - Press the **F8** key repeatedly as the computer is booting to bring up the **Advanced Boot Options** menu.
   - Select **Repair Your Computer** from the list and press **Enter**.

   <img width="350" alt="Advanced Boot Options" src="https://github.com/YourRepo/YourImagePath/repair-options.png">

‚ë¢ **Access the Command Prompt:**
   - Once the **System Recovery Options** window appears, choose your keyboard layout and click **Next**.
   - Select the **Command Prompt** option from the list of recovery tools.

   <img width="350" alt="System Recovery Options" src="https://github.com/YourRepo/YourImagePath/system-recovery-options.png">

‚ë£ **Backup and Replace sethc.exe:**
   - In the Command Prompt, navigate to the `System32` directory by typing the following command:

     ```cmd
     cd C:\Windows\System32
     ```

   - Backup the existing `sethc.exe` (Sticky Keys) file:

     ```cmd
     ren sethc.exe sethc_backup.exe
     ```

   - Replace `sethc.exe` with `cmd.exe`:

     ```cmd
     copy cmd.exe sethc.exe
     ```

   This will allow the Command Prompt to launch instead of Sticky Keys when you press the **Shift** key five times on the login screen.

‚ë§ **Trigger the Command Prompt from the Login Screen:**
   - Restart the computer.
   - At the login screen, press the **Shift** key five times in quick succession. This will launch the Command Prompt with administrator privileges instead of the Sticky Keys prompt.

   <img width="350" alt="Sticky Keys Exploit" src="https://github.com/YourRepo/YourImagePath/sticky-keys-exploit.png">

‚ë• **Change the Forgotten Password:**
   - In the Command Prompt, enter the following command to reset the password for the target user account:

     ```cmd
     net user [username] [newpassword]
     ```

   - Replace `[username]` with the actual username of the account you wish to reset, and replace `[newpassword]` with the new password you want to set.

   - For example:

     ```cmd
     net user JaneDoe P@ssw0rd123
     ```

   - Press **Enter** to execute the command and reset the password.

‚ë¶ **Restore the Original sethc.exe File:**
   - After successfully resetting the password, it‚Äôs important to restore the original `sethc.exe` file to prevent future unauthorized access using this method.
   - Reopen the Command Prompt (if it was closed) by pressing **Shift** five times again and run the following command:

     ```cmd
     copy sethc_backup.exe sethc.exe
     ```

   - Confirm the file replacement when prompted.

   - This will restore Sticky Keys functionality back to normal.

‚ëß **Log In with the New Password:**
   - Close the Command Prompt and log in using the new password you created.
   - Ensure that everything is functioning as expected and that Sticky Keys is restored.


## **Why This Exploit Works**

**Pre-Login Accessibility:**  
The exploit leverages Windows' pre-login accessibility feature, allowing users to access Sticky Keys before logging in.

**Privilege Elevation:**  
Replacing `sethc.exe` with `cmd.exe` grants SYSTEM privileges, enabling password resets and other system changes without authentication.

---

## **Security Risks and Implications**

- **Unauthenticated Access:**  
  This flaw allows anyone with physical access to the machine to gain control over the system.
  
- **Physical Security:**  
  Emphasizes the importance of securing physical access to machines running older Windows versions.

---

## **Mitigations in Newer Windows Versions**

**Windows 10/11 Enhancements:**
- **Secure Boot & UEFI:**  
  These features prevent unauthorized changes to system files, making it harder to exploit vulnerabilities.
  
- **BitLocker Encryption:**  
  With BitLocker enabled, accessing or modifying system files requires a recovery key.

- **System File Protection:**  
  Improved protection in Windows 10/11 requires elevated privileges for system changes.

---

## **Is This Exploit Still Possible in Windows 10/11?**

**Possible, but Difficult:**  
While possible, executing this exploit on Windows 10/11 is much harder due to the enhanced security features like Secure Boot, UEFI, and BitLocker.

**Workarounds:**  
- **Third-Party Tools:**  
  Password recovery tools like PCUnlocker or PassFab 4WinKey can reset passwords, but they require bootable media and bypassing security measures.

- **Offline Methods:**  
  With physical access, offline password recovery methods might still work, though the process is more complex due to additional security layers.

## Conclusion

This project demonstrates how the Sticky Keys exploit can be used to reset a password on a Windows 7 machine. While effective on older systems, this method highlights a significant security flaw that has been largely mitigated in modern versions of Windows. Protecting physical access to machines and enabling security features like BitLocker and Secure Boot are essential to preventing unauthorized access.

<h1><p align=center> DONE! Good job! </p></h1>

<h2><p align=center>The Next Demonstration:<br><a href="https://github.com/terikaj/osticket-prereqs"> osTicket: Prerequisites and Installation </a></p></h2>


